<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Caisse rapide ‚Äì avec compteurs</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; margin:0; background:#0f1217; color:#e6e9ef}
  header{padding:12px; background:#171b22}
  h1{margin:0; font-size:18px}
  .grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(120px,1fr)); gap:8px; padding:12px}
  .item{position:relative; background:#0e131a; border:1px solid #222833; border-radius:10px; padding:10px; text-align:center; cursor:pointer}
  .item span{display:block; font-size:24px}
  .badge{position:absolute; top:6px; right:6px; background:#3b82f6; color:white; border-radius:999px; padding:2px 6px; font-size:12px; display:none}
  .panel{background:#171b22; margin:12px; padding:12px; border-radius:10px}
  .big{font-size:28px; font-weight:700}
  input{width:100%; height:40px; border-radius:8px; border:1px solid #243042; background:#0b1016; color:white; padding:0 10px; font-size:16px}
  button{margin-top:8px; width:100%; height:40px; border-radius:8px; border:1px solid #243042; background:#3b82f6; color:white; font-size:16px; cursor:pointer}
  .denoms{display:flex; flex-wrap:wrap; gap:6px; margin-top:6px}
  .chip{border:1px solid #243042; padding:4px 8px; border-radius:999px; font-size:12px}
</style>
</head>
<body>
  <header><h1>üçπ Caisse rapide</h1></header>

  <div class="grid">
    <div class="item" data-price="0.80" data-id="soda"><div class="badge">0</div><span>ü•§</span>Soda<br>0,80 ‚Ç¨</div>
    <div class="item" data-price="0.90" data-id="jus"><div class="badge">0</div><span>üßÉ</span>Jus<br>0,90 ‚Ç¨</div>
    <div class="item" data-price="1.00" data-id="pression"><div class="badge">0</div><span>üç∫</span>Pression<br>1,00 ‚Ç¨</div>
    <div class="item" data-price="2.00" data-id="speciale"><div class="badge">0</div><span>üçª</span>Sp√©ciale<br>2,00 ‚Ç¨</div>
    <div class="item" data-price="0.50" data-id="cafe"><div class="badge">0</div><span>‚òï</span>Caf√©<br>0,50 ‚Ç¨</div>
  </div>

  <div class="panel">
    <div>Total : <span class="big" id="total">0,00 ‚Ç¨</span></div>
    <div>Articles : <span id="count">0</span></div>
  </div>

  <div class="panel">
    <label>Montant donn√© (‚Ç¨)</label>
    <input id="cashGiven" placeholder="0,00">
    <button id="calcChange">Calculer rendu</button>
    <div id="changeBox" style="margin-top:8px; display:none">
      <strong>Rendu de monnaie :</strong> <span id="changeTxt">0,00 ‚Ç¨</span>
      <div class="denoms" id="denomsBox"></div>
    </div>
  </div>

<script>
  const fmt = new Intl.NumberFormat('fr-FR',{style:'currency',currency:'EUR'});
  const toCents = (v) => Math.round(parseFloat(String(v).replace(',','.'))*100);
  const fromCents = (c) => fmt.format(c/100);

  let total = 0, count = 0;
  const counters = {};

  // Ajout articles
  document.querySelectorAll('.item').forEach(el=>{
    const id = el.dataset.id;
    counters[id] = 0;
    const badge = el.querySelector('.badge');
    el.addEventListener('click', ()=>{
      total += parseFloat(el.dataset.price);
      count++;
      counters[id]++;
      // mettre √† jour affichages
      document.getElementById('total').textContent = fmt.format(total);
      document.getElementById('count').textContent = count;
      badge.textContent = counters[id];
      badge.style.display = counters[id] > 0 ? 'inline-block' : 'none';
    });
  });

  // Calcul rendu
  document.getElementById('calcChange').addEventListener('click', ()=>{
    const given = toCents(document.getElementById('cashGiven').value||'0');
    const due = Math.round(total*100);
    const change = given - due;
    const $box = document.getElementById('changeBox');
    const $txt = document.getElementById('changeTxt');
    const $denoms = document.getElementById('denomsBox');
    if(change < 0){
      $box.style.display = 'block';
      $txt.textContent = `Montant insuffisant (manque ${fromCents(-change)})`;
      $denoms.innerHTML = '';
      return;
    }
    $box.style.display = 'block';
    $txt.textContent = fromCents(change);
    // D√©composition billets/pi√®ces
    const denoms = [20000,10000,5000,2000,1000,500,200,100,50,20,10,5];
    let rest = change, chips = [];
    for(const d of denoms){
      const n = Math.floor(rest/d);
      if(n>0){ chips.push(`${n} √ó ${fromCents(d)}`); rest -= n*d; }
    }
    $denoms.innerHTML = chips.map(c=>`<span class="chip">${c}</span>`).join('');
  });
</script>
</body>
</html>
